<html>

<head>
    <title>Retina</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <script type="text/javascript" src="charts.js"></script>

</head>

<body>
    <span style="display: flex; justify-content: center; align-items: center; width: fit-content;">
        <div class="eye">
            <div class="eyeball"></div>
        </div>
        <h1 style = "font-size: 2vw;">Retina</h1>
        <a style = "position: absolute; right: 5%; cursor: pointer;"><u>Report to your Doctor</u></a>
    </span>

    <h1 class="heading">Eye State : <span style="color: #A8E4A0;">Healthy</span></h1>
    <div class="data">
        <h2 class="item">Blink rate : 13</h2>
        <h2 class="item">Dryness levels : 0.2</h2>
        <h2 class="item">Screen time : 4.6 hrs</h2>
    </div>
    </div>
    <div class="togglebutton previous" id="previous">&larr;</div>
    <div class="togglebutton next" id="next">&rarr;</div>
    <div class="graph"></div>
    <div class="calender">
        <div class="togglebutton" id=1>Show Daily Data</div>
        <div class="togglebutton" id=2>Show Total Activity</div>
    </div>








    <script>
        const currentDate = new Date()
        let blinkData = []

        var prev = document.querySelector('#previous')
        prev.addEventListener('click', () => {
            currentDate.setDate(currentDate.getDate() - 1)
            setData()

        })
        var next = document.querySelector('#next')
        prev.addEventListener('click', () => {
            currentDate.setDate(currentDate.getDate() + 1)
            setData()
        })

        function setData() {
            const datestring = currentDate.toISOString().slice(0, 10)
            const currentData = blinkData[datestring]
            let data = currentData.values().map((item) => item[0])
            let xlabel = currentData.keys()
        }
        async function getData() {
            const url = `http://localhost:5000/`;
            const response = await fetch(url);
            const data = await response.json();
            blinkData = data
            setData()
        }
        getData()

        function renderChart(data, xlabel) {
            window.Apex = {
                chart: {
                    foreColor: 'wheat',
                    toolbar: {
                        show: false
                    },
                },
                stroke: {
                    width: 3
                },
                tooltip: {
                    theme: 'dark'
                }
            };
            var lineGraph = {
                chart: {
                    height: 370,
                    type: 'line',
                    zoom: {
                        enabled: false
                    },
                    dropShadow: {
                        enabled: true,
                        top: 3,
                        left: 2,
                        blur: 4,
                        opacity: 1,
                    }
                },
                series: [{
                    name: "Blink Rate",
                    data: data
                }],
                markers: {
                    size: 6,
                    strokeWidth: 0,
                    hover: {
                        size: 9
                    }
                },
                labels: xlabel,
                xaxis: {
                    tooltip: {
                        enabled: false
                    }
                },
                annotations: {
                    yaxis: [{
                        y: 8,
                        y2: 22,
                        borderColor: '#000',
                        fillColor: '#3B7A57',
                    }]
                }
            }

            var chart = new ApexCharts(document.querySelector('.graph'), lineGraph);
            chart.render();

        }
    </script>
</body>

</html>